---
phase: 01-apk-parity-release-hardening
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: []
autonomous: true
user_setup:
  - service: eas
    why: "Build Android APK"
    env_vars:
      - name: EAS_PROJECT_ID
        source: "From existing app.json (8d8644dd-aecd-4a14-ac43-32a15e24a0c4)"

must_haves:
  truths:
    - "APK builds successfully via EAS"
    - "APK installs and runs on Android device"
    - "All core wallet features work in APK"
  artifacts:
    - path: "zero-auth-wallet/android"
      provides: "Native Android project"
    - path: "zero-auth-wallet/build/apk.apk"
      provides: "Built APK file"
  key_links:
    - from: "eas.json"
      to: "android build"
      via: "eas build command"
---
<objective>
Set up EAS build infrastructure and verify the Android APK builds and runs correctly.

Purpose: Ensure the wallet can be built as a standalone APK that works without Expo Go
Output: Working APK with all core features
</objective>

<execution_context>
@~/.config/opencode/get-shit-done/workflows/execute-plan.md
@~/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/phases/01-apk-parity-release-hardening/01-CONTEXT.md
@zero-auth-wallet/app.json
@zero-auth-wallet/eas.json
@zero-auth-wallet/package.json

# Codebase patterns
@zero-auth-wallet/app/_layout.tsx
@zero-auth-wallet/store/auth-store.ts
</context>

<tasks>

<task type="auto">
  <name>Generate Android native project</name>
  <files>zero-auth-wallet/android/</files>
  <action>
    Run expo prebuild to generate native Android project:
    ```bash
    cd zero-auth-wallet && npx expo prebuild --platform android --clean
    ```
    
    This creates the android/ directory with Gradle configuration.
  </action>
  <verify>
    Directory android/ exists with build.gradle and app/build.gradle files
  </verify>
  <done>
    Android native project generated at zero-auth-wallet/android/
  </done>
</task>

<task type="auto">
  <name>Build debug APK with bundled JS</name>
  <files>zero-auth-wallet/build/apk.apk</files>
  <action>
    Build the debug APK using EAS:
    ```bash
    cd zero-auth-wallet && npx eas build --platform android --profile development --local
    ```
    
    Or if that fails, use direct gradle:
    ```bash
    cd zero-auth-wallet/android && ./gradlew assembleDebug
    ```
    
    Ensure JS bundle is included in the APK (not loaded from Metro).
  </action>
  <verify>
    APK file exists at zero-auth-wallet/android/app/build/outputs/apk/debug/app-debug.apk
  </verify>
  <done>
    APK successfully built with bundled JavaScript
  </done>
</task>

<task type="auto">
  <name>Verify core features in APK</name>
  <files>zero-auth-wallet/app/(tabs)/credentials.tsx</files>
  <action>
    Verify the built APK contains all core features by checking:
    1. Credentials screen renders (add/revoke flow exists)
    2. Scanner screen exists (expo-camera integration)
    3. My QR screen exists
    4. Verification flow exists
    
    These files should already exist - just verify they're included in the build.
  </action>
  <verify>
    All required screens present in codebase
  </verify>
  <done>
    Core wallet features confirmed in source code
  </done>
</task>

</tasks>

<verification>
1. Check android/ directory exists with proper Gradle files
2. Check APK was generated
3. Confirm JS bundle is included (not dependent on Metro)
</verification>

<success_criteria>
- [ ] `npx expo prebuild --platform android` completes successfully
- [ ] APK builds without errors
- [ ] APK contains bundled JavaScript
</success_criteria>

<output>
After completion, create `.planning/phases/01-apk-parity-release-hardening/01-01-SUMMARY.md`
</output>
